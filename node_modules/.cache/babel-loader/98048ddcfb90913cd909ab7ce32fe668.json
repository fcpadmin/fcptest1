{"ast":null,"code":"import _objectSpread from \"/Users/matthewmcelwee/fcprepos/webtest1/flex-template-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nvar _jsxFileName = \"/Users/matthewmcelwee/fcprepos/webtest1/flex-template-web/src/components/SearchFilters/SearchFilters.js\";\nimport React from 'react';\nimport { compose } from 'redux';\nimport { object, string, bool, number, func, shape } from 'prop-types';\nimport { injectIntl, intlShape, FormattedMessage } from 'react-intl';\nimport classNames from 'classnames';\nimport { withRouter } from 'react-router-dom';\nimport omit from 'lodash/omit';\nimport { BookingDateRangeFilter, SelectSingleFilter, SelectMultipleFilter, PriceFilter } from '../../components';\nimport routeConfiguration from '../../routeConfiguration';\nimport { parseDateFromISO8601, stringifyDateToISO8601 } from '../../util/dates';\nimport { createResourceLocatorString } from '../../util/routes';\nimport { propTypes } from '../../util/types';\nimport css from './SearchFilters.css'; // Dropdown container can have a positional offset (in pixels)\n\nconst FILTER_DROPDOWN_OFFSET = -14;\nconst RADIX = 10; // resolve initial value for a single value filter\n\nconst initialValue = (queryParams, paramName) => {\n  return queryParams[paramName];\n}; // resolve initial values for a multi value filter\n\n\nconst initialValues = (queryParams, paramName) => {\n  return !!queryParams[paramName] ? queryParams[paramName].split(',') : [];\n};\n\nconst initialPriceRangeValue = (queryParams, paramName) => {\n  const price = queryParams[paramName];\n  const valuesFromParams = !!price ? price.split(',').map(v => Number.parseInt(v, RADIX)) : [];\n  return !!price && valuesFromParams.length === 2 ? {\n    minPrice: valuesFromParams[0],\n    maxPrice: valuesFromParams[1]\n  } : null;\n};\n\nconst initialDateRangeValue = (queryParams, paramName) => {\n  const dates = queryParams[paramName];\n  const rawValuesFromParams = !!dates ? dates.split(',') : [];\n  const valuesFromParams = rawValuesFromParams.map(v => parseDateFromISO8601(v));\n  const initialValues = !!dates && valuesFromParams.length === 2 ? {\n    dates: {\n      startDate: valuesFromParams[0],\n      endDate: valuesFromParams[1]\n    }\n  } : {\n    dates: null\n  };\n  return initialValues;\n};\n\nconst SearchFiltersComponent = props => {\n  const rootClassName = props.rootClassName,\n        className = props.className,\n        urlQueryParams = props.urlQueryParams,\n        listingsAreLoaded = props.listingsAreLoaded,\n        resultsCount = props.resultsCount,\n        searchInProgress = props.searchInProgress,\n        categoryFilter = props.categoryFilter,\n        amenitiesFilter = props.amenitiesFilter,\n        priceFilter = props.priceFilter,\n        dateRangeFilter = props.dateRangeFilter,\n        isSearchFiltersPanelOpen = props.isSearchFiltersPanelOpen,\n        toggleSearchFiltersPanel = props.toggleSearchFiltersPanel,\n        searchFiltersPanelSelectedCount = props.searchFiltersPanelSelectedCount,\n        history = props.history,\n        intl = props.intl;\n  const hasNoResult = listingsAreLoaded && resultsCount === 0;\n  const classes = classNames(rootClassName || css.root, {\n    [css.longInfo]: hasNoResult\n  }, className);\n  const categoryLabel = intl.formatMessage({\n    id: 'SearchFilters.categoryLabel'\n  });\n  const amenitiesLabel = intl.formatMessage({\n    id: 'SearchFilters.amenitiesLabel'\n  });\n  const initialAmenities = amenitiesFilter ? initialValues(urlQueryParams, amenitiesFilter.paramName) : null;\n  const initialCategory = categoryFilter ? initialValue(urlQueryParams, categoryFilter.paramName) : null;\n  const initialPriceRange = priceFilter ? initialPriceRangeValue(urlQueryParams, priceFilter.paramName) : null;\n  const initialDateRange = dateRangeFilter ? initialDateRangeValue(urlQueryParams, dateRangeFilter.paramName) : null;\n\n  const handleSelectOptions = (urlParam, options) => {\n    const queryParams = options && options.length > 0 ? _objectSpread({}, urlQueryParams, {\n      [urlParam]: options.join(',')\n    }) : omit(urlQueryParams, urlParam);\n    history.push(createResourceLocatorString('SearchPage', routeConfiguration(), {}, queryParams));\n  };\n\n  const handleSelectOption = (urlParam, option) => {\n    // query parameters after selecting the option\n    // if no option is passed, clear the selection for the filter\n    const queryParams = option ? _objectSpread({}, urlQueryParams, {\n      [urlParam]: option\n    }) : omit(urlQueryParams, urlParam);\n    history.push(createResourceLocatorString('SearchPage', routeConfiguration(), {}, queryParams));\n  };\n\n  const handlePrice = (urlParam, range) => {\n    const _ref = range || {},\n          minPrice = _ref.minPrice,\n          maxPrice = _ref.maxPrice;\n\n    const queryParams = minPrice != null && maxPrice != null ? _objectSpread({}, urlQueryParams, {\n      [urlParam]: \"\".concat(minPrice, \",\").concat(maxPrice)\n    }) : omit(urlQueryParams, urlParam);\n    history.push(createResourceLocatorString('SearchPage', routeConfiguration(), {}, queryParams));\n  };\n\n  const handleDateRange = (urlParam, dateRange) => {\n    const hasDates = dateRange && dateRange.dates;\n\n    const _ref2 = hasDates ? dateRange.dates : {},\n          startDate = _ref2.startDate,\n          endDate = _ref2.endDate;\n\n    const start = startDate ? stringifyDateToISO8601(startDate) : null;\n    const end = endDate ? stringifyDateToISO8601(endDate) : null;\n    const queryParams = start != null && end != null ? _objectSpread({}, urlQueryParams, {\n      [urlParam]: \"\".concat(start, \",\").concat(end)\n    }) : omit(urlQueryParams, urlParam);\n    history.push(createResourceLocatorString('SearchPage', routeConfiguration(), {}, queryParams));\n  };\n\n  const categoryFilterElement = categoryFilter ? React.createElement(SelectSingleFilter, {\n    urlParam: categoryFilter.paramName,\n    label: categoryLabel,\n    onSelect: handleSelectOption,\n    showAsPopup: true,\n    options: categoryFilter.options,\n    initialValue: initialCategory,\n    contentPlacementOffset: FILTER_DROPDOWN_OFFSET,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151\n    },\n    __self: this\n  }) : null;\n  const amenitiesFilterElement = amenitiesFilter ? React.createElement(SelectMultipleFilter, {\n    id: 'SearchFilters.amenitiesFilter',\n    name: \"amenities\",\n    urlParam: amenitiesFilter.paramName,\n    label: amenitiesLabel,\n    onSubmit: handleSelectOptions,\n    showAsPopup: true,\n    options: amenitiesFilter.options,\n    initialValues: initialAmenities,\n    contentPlacementOffset: FILTER_DROPDOWN_OFFSET,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163\n    },\n    __self: this\n  }) : null;\n  const priceFilterElement = priceFilter ? React.createElement(PriceFilter, Object.assign({\n    id: \"SearchFilters.priceFilter\",\n    urlParam: priceFilter.paramName,\n    onSubmit: handlePrice,\n    showAsPopup: true\n  }, priceFilter.config, {\n    initialValues: initialPriceRange,\n    contentPlacementOffset: FILTER_DROPDOWN_OFFSET,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177\n    },\n    __self: this\n  })) : null;\n  const dateRangeFilterElement = dateRangeFilter && dateRangeFilter.config.active ? React.createElement(BookingDateRangeFilter, {\n    id: \"SearchFilters.dateRangeFilter\",\n    urlParam: dateRangeFilter.paramName,\n    onSubmit: handleDateRange,\n    showAsPopup: true,\n    contentPlacementOffset: FILTER_DROPDOWN_OFFSET,\n    initialValues: initialDateRange,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190\n    },\n    __self: this\n  }) : null;\n  const toggleSearchFiltersPanelButtonClasses = isSearchFiltersPanelOpen || searchFiltersPanelSelectedCount > 0 ? css.searchFiltersPanelOpen : css.searchFiltersPanelClosed;\n  const toggleSearchFiltersPanelButton = toggleSearchFiltersPanel ? React.createElement(\"button\", {\n    className: toggleSearchFiltersPanelButtonClasses,\n    onClick: () => {\n      toggleSearchFiltersPanel(!isSearchFiltersPanelOpen);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 205\n    },\n    __self: this\n  }, React.createElement(FormattedMessage, {\n    id: \"SearchFilters.moreFiltersButton\",\n    values: {\n      count: searchFiltersPanelSelectedCount\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 211\n    },\n    __self: this\n  })) : null;\n  return React.createElement(\"div\", {\n    className: classes,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: css.filters,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219\n    },\n    __self: this\n  }, categoryFilterElement, amenitiesFilterElement, priceFilterElement, dateRangeFilterElement, toggleSearchFiltersPanelButton), listingsAreLoaded && resultsCount > 0 ? React.createElement(\"div\", {\n    className: css.searchResultSummary,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 228\n    },\n    __self: this\n  }, React.createElement(\"span\", {\n    className: css.resultsFound,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 229\n    },\n    __self: this\n  }, React.createElement(FormattedMessage, {\n    id: \"SearchFilters.foundResults\",\n    values: {\n      count: resultsCount\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 230\n    },\n    __self: this\n  }))) : null, hasNoResult ? React.createElement(\"div\", {\n    className: css.noSearchResults,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 236\n    },\n    __self: this\n  }, React.createElement(FormattedMessage, {\n    id: \"SearchFilters.noResults\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 237\n    },\n    __self: this\n  })) : null, searchInProgress ? React.createElement(\"div\", {\n    className: css.loadingResults,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 242\n    },\n    __self: this\n  }, React.createElement(FormattedMessage, {\n    id: \"SearchFilters.loadingResults\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 243\n    },\n    __self: this\n  })) : null);\n};\n\nSearchFiltersComponent.defaultProps = {\n  rootClassName: null,\n  className: null,\n  resultsCount: null,\n  searchingInProgress: false,\n  categoryFilter: null,\n  amenitiesFilter: null,\n  priceFilter: null,\n  dateRangeFilter: null,\n  isSearchFiltersPanelOpen: false,\n  toggleSearchFiltersPanel: null,\n  searchFiltersPanelSelectedCount: 0\n};\nSearchFiltersComponent.propTypes = {\n  rootClassName: string,\n  className: string,\n  urlQueryParams: object.isRequired,\n  listingsAreLoaded: bool.isRequired,\n  resultsCount: number,\n  searchingInProgress: bool,\n  onManageDisableScrolling: func.isRequired,\n  categoriesFilter: propTypes.filterConfig,\n  amenitiesFilter: propTypes.filterConfig,\n  priceFilter: propTypes.filterConfig,\n  dateRangeFilter: propTypes.filterConfig,\n  isSearchFiltersPanelOpen: bool,\n  toggleSearchFiltersPanel: func,\n  searchFiltersPanelSelectedCount: number,\n  // from withRouter\n  history: shape({\n    push: func.isRequired\n  }).isRequired,\n  // from injectIntl\n  intl: intlShape.isRequired\n};\nconst SearchFilters = compose(withRouter, injectIntl)(SearchFiltersComponent);\nexport default SearchFilters;","map":{"version":3,"sources":["/Users/matthewmcelwee/fcprepos/webtest1/flex-template-web/src/components/SearchFilters/SearchFilters.js"],"names":["React","compose","object","string","bool","number","func","shape","injectIntl","intlShape","FormattedMessage","classNames","withRouter","omit","BookingDateRangeFilter","SelectSingleFilter","SelectMultipleFilter","PriceFilter","routeConfiguration","parseDateFromISO8601","stringifyDateToISO8601","createResourceLocatorString","propTypes","css","FILTER_DROPDOWN_OFFSET","RADIX","initialValue","queryParams","paramName","initialValues","split","initialPriceRangeValue","price","valuesFromParams","map","v","Number","parseInt","length","minPrice","maxPrice","initialDateRangeValue","dates","rawValuesFromParams","startDate","endDate","SearchFiltersComponent","props","rootClassName","className","urlQueryParams","listingsAreLoaded","resultsCount","searchInProgress","categoryFilter","amenitiesFilter","priceFilter","dateRangeFilter","isSearchFiltersPanelOpen","toggleSearchFiltersPanel","searchFiltersPanelSelectedCount","history","intl","hasNoResult","classes","root","longInfo","categoryLabel","formatMessage","id","amenitiesLabel","initialAmenities","initialCategory","initialPriceRange","initialDateRange","handleSelectOptions","urlParam","options","join","push","handleSelectOption","option","handlePrice","range","handleDateRange","dateRange","hasDates","start","end","categoryFilterElement","amenitiesFilterElement","priceFilterElement","config","dateRangeFilterElement","active","toggleSearchFiltersPanelButtonClasses","searchFiltersPanelOpen","searchFiltersPanelClosed","toggleSearchFiltersPanelButton","count","filters","searchResultSummary","resultsFound","noSearchResults","loadingResults","defaultProps","searchingInProgress","isRequired","onManageDisableScrolling","categoriesFilter","filterConfig","SearchFilters"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { compose } from 'redux';\nimport { object, string, bool, number, func, shape } from 'prop-types';\nimport { injectIntl, intlShape, FormattedMessage } from 'react-intl';\nimport classNames from 'classnames';\nimport { withRouter } from 'react-router-dom';\nimport omit from 'lodash/omit';\n\nimport {\n  BookingDateRangeFilter,\n  SelectSingleFilter,\n  SelectMultipleFilter,\n  PriceFilter,\n} from '../../components';\nimport routeConfiguration from '../../routeConfiguration';\nimport { parseDateFromISO8601, stringifyDateToISO8601 } from '../../util/dates';\nimport { createResourceLocatorString } from '../../util/routes';\nimport { propTypes } from '../../util/types';\nimport css from './SearchFilters.css';\n\n// Dropdown container can have a positional offset (in pixels)\nconst FILTER_DROPDOWN_OFFSET = -14;\nconst RADIX = 10;\n\n// resolve initial value for a single value filter\nconst initialValue = (queryParams, paramName) => {\n  return queryParams[paramName];\n};\n\n// resolve initial values for a multi value filter\nconst initialValues = (queryParams, paramName) => {\n  return !!queryParams[paramName] ? queryParams[paramName].split(',') : [];\n};\n\nconst initialPriceRangeValue = (queryParams, paramName) => {\n  const price = queryParams[paramName];\n  const valuesFromParams = !!price ? price.split(',').map(v => Number.parseInt(v, RADIX)) : [];\n\n  return !!price && valuesFromParams.length === 2\n    ? {\n        minPrice: valuesFromParams[0],\n        maxPrice: valuesFromParams[1],\n      }\n    : null;\n};\n\nconst initialDateRangeValue = (queryParams, paramName) => {\n  const dates = queryParams[paramName];\n  const rawValuesFromParams = !!dates ? dates.split(',') : [];\n  const valuesFromParams = rawValuesFromParams.map(v => parseDateFromISO8601(v));\n  const initialValues =\n    !!dates && valuesFromParams.length === 2\n      ? {\n          dates: { startDate: valuesFromParams[0], endDate: valuesFromParams[1] },\n        }\n      : { dates: null };\n\n  return initialValues;\n};\n\nconst SearchFiltersComponent = props => {\n  const {\n    rootClassName,\n    className,\n    urlQueryParams,\n    listingsAreLoaded,\n    resultsCount,\n    searchInProgress,\n    categoryFilter,\n    amenitiesFilter,\n    priceFilter,\n    dateRangeFilter,\n    isSearchFiltersPanelOpen,\n    toggleSearchFiltersPanel,\n    searchFiltersPanelSelectedCount,\n    history,\n    intl,\n  } = props;\n\n  const hasNoResult = listingsAreLoaded && resultsCount === 0;\n  const classes = classNames(rootClassName || css.root, { [css.longInfo]: hasNoResult }, className);\n\n  const categoryLabel = intl.formatMessage({\n    id: 'SearchFilters.categoryLabel',\n  });\n\n  const amenitiesLabel = intl.formatMessage({\n    id: 'SearchFilters.amenitiesLabel',\n  });\n\n  const initialAmenities = amenitiesFilter\n    ? initialValues(urlQueryParams, amenitiesFilter.paramName)\n    : null;\n\n  const initialCategory = categoryFilter\n    ? initialValue(urlQueryParams, categoryFilter.paramName)\n    : null;\n\n  const initialPriceRange = priceFilter\n    ? initialPriceRangeValue(urlQueryParams, priceFilter.paramName)\n    : null;\n\n  const initialDateRange = dateRangeFilter\n    ? initialDateRangeValue(urlQueryParams, dateRangeFilter.paramName)\n    : null;\n\n  const handleSelectOptions = (urlParam, options) => {\n    const queryParams =\n      options && options.length > 0\n        ? { ...urlQueryParams, [urlParam]: options.join(',') }\n        : omit(urlQueryParams, urlParam);\n\n    history.push(createResourceLocatorString('SearchPage', routeConfiguration(), {}, queryParams));\n  };\n\n  const handleSelectOption = (urlParam, option) => {\n    // query parameters after selecting the option\n    // if no option is passed, clear the selection for the filter\n    const queryParams = option\n      ? { ...urlQueryParams, [urlParam]: option }\n      : omit(urlQueryParams, urlParam);\n\n    history.push(createResourceLocatorString('SearchPage', routeConfiguration(), {}, queryParams));\n  };\n\n  const handlePrice = (urlParam, range) => {\n    const { minPrice, maxPrice } = range || {};\n    const queryParams =\n      minPrice != null && maxPrice != null\n        ? { ...urlQueryParams, [urlParam]: `${minPrice},${maxPrice}` }\n        : omit(urlQueryParams, urlParam);\n\n    history.push(createResourceLocatorString('SearchPage', routeConfiguration(), {}, queryParams));\n  };\n\n  const handleDateRange = (urlParam, dateRange) => {\n    const hasDates = dateRange && dateRange.dates;\n    const { startDate, endDate } = hasDates ? dateRange.dates : {};\n\n    const start = startDate ? stringifyDateToISO8601(startDate) : null;\n    const end = endDate ? stringifyDateToISO8601(endDate) : null;\n\n    const queryParams =\n      start != null && end != null\n        ? { ...urlQueryParams, [urlParam]: `${start},${end}` }\n        : omit(urlQueryParams, urlParam);\n    history.push(createResourceLocatorString('SearchPage', routeConfiguration(), {}, queryParams));\n  };\n\n  const categoryFilterElement = categoryFilter ? (\n    <SelectSingleFilter\n      urlParam={categoryFilter.paramName}\n      label={categoryLabel}\n      onSelect={handleSelectOption}\n      showAsPopup\n      options={categoryFilter.options}\n      initialValue={initialCategory}\n      contentPlacementOffset={FILTER_DROPDOWN_OFFSET}\n    />\n  ) : null;\n\n  const amenitiesFilterElement = amenitiesFilter ? (\n    <SelectMultipleFilter\n      id={'SearchFilters.amenitiesFilter'}\n      name=\"amenities\"\n      urlParam={amenitiesFilter.paramName}\n      label={amenitiesLabel}\n      onSubmit={handleSelectOptions}\n      showAsPopup\n      options={amenitiesFilter.options}\n      initialValues={initialAmenities}\n      contentPlacementOffset={FILTER_DROPDOWN_OFFSET}\n    />\n  ) : null;\n\n  const priceFilterElement = priceFilter ? (\n    <PriceFilter\n      id=\"SearchFilters.priceFilter\"\n      urlParam={priceFilter.paramName}\n      onSubmit={handlePrice}\n      showAsPopup\n      {...priceFilter.config}\n      initialValues={initialPriceRange}\n      contentPlacementOffset={FILTER_DROPDOWN_OFFSET}\n    />\n  ) : null;\n\n  const dateRangeFilterElement =\n    dateRangeFilter && dateRangeFilter.config.active ? (\n      <BookingDateRangeFilter\n        id=\"SearchFilters.dateRangeFilter\"\n        urlParam={dateRangeFilter.paramName}\n        onSubmit={handleDateRange}\n        showAsPopup\n        contentPlacementOffset={FILTER_DROPDOWN_OFFSET}\n        initialValues={initialDateRange}\n      />\n    ) : null;\n\n  const toggleSearchFiltersPanelButtonClasses =\n    isSearchFiltersPanelOpen || searchFiltersPanelSelectedCount > 0\n      ? css.searchFiltersPanelOpen\n      : css.searchFiltersPanelClosed;\n  const toggleSearchFiltersPanelButton = toggleSearchFiltersPanel ? (\n    <button\n      className={toggleSearchFiltersPanelButtonClasses}\n      onClick={() => {\n        toggleSearchFiltersPanel(!isSearchFiltersPanelOpen);\n      }}\n    >\n      <FormattedMessage\n        id=\"SearchFilters.moreFiltersButton\"\n        values={{ count: searchFiltersPanelSelectedCount }}\n      />\n    </button>\n  ) : null;\n  return (\n    <div className={classes}>\n      <div className={css.filters}>\n        {categoryFilterElement}\n        {amenitiesFilterElement}\n        {priceFilterElement}\n        {dateRangeFilterElement}\n        {toggleSearchFiltersPanelButton}\n      </div>\n\n      {listingsAreLoaded && resultsCount > 0 ? (\n        <div className={css.searchResultSummary}>\n          <span className={css.resultsFound}>\n            <FormattedMessage id=\"SearchFilters.foundResults\" values={{ count: resultsCount }} />\n          </span>\n        </div>\n      ) : null}\n\n      {hasNoResult ? (\n        <div className={css.noSearchResults}>\n          <FormattedMessage id=\"SearchFilters.noResults\" />\n        </div>\n      ) : null}\n\n      {searchInProgress ? (\n        <div className={css.loadingResults}>\n          <FormattedMessage id=\"SearchFilters.loadingResults\" />\n        </div>\n      ) : null}\n    </div>\n  );\n};\n\nSearchFiltersComponent.defaultProps = {\n  rootClassName: null,\n  className: null,\n  resultsCount: null,\n  searchingInProgress: false,\n  categoryFilter: null,\n  amenitiesFilter: null,\n  priceFilter: null,\n  dateRangeFilter: null,\n  isSearchFiltersPanelOpen: false,\n  toggleSearchFiltersPanel: null,\n  searchFiltersPanelSelectedCount: 0,\n};\n\nSearchFiltersComponent.propTypes = {\n  rootClassName: string,\n  className: string,\n  urlQueryParams: object.isRequired,\n  listingsAreLoaded: bool.isRequired,\n  resultsCount: number,\n  searchingInProgress: bool,\n  onManageDisableScrolling: func.isRequired,\n  categoriesFilter: propTypes.filterConfig,\n  amenitiesFilter: propTypes.filterConfig,\n  priceFilter: propTypes.filterConfig,\n  dateRangeFilter: propTypes.filterConfig,\n  isSearchFiltersPanelOpen: bool,\n  toggleSearchFiltersPanel: func,\n  searchFiltersPanelSelectedCount: number,\n\n  // from withRouter\n  history: shape({\n    push: func.isRequired,\n  }).isRequired,\n\n  // from injectIntl\n  intl: intlShape.isRequired,\n};\n\nconst SearchFilters = compose(\n  withRouter,\n  injectIntl\n)(SearchFiltersComponent);\n\nexport default SearchFilters;\n"]},"metadata":{},"sourceType":"module"}