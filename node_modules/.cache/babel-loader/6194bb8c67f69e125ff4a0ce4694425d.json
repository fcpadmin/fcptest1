{"ast":null,"code":"import _objectWithoutProperties from \"/Users/matthewmcelwee/fcprepos/webtest1/flex-template-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _objectSpread from \"/Users/matthewmcelwee/fcprepos/webtest1/flex-template-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport unionWith from 'lodash/unionWith';\nimport { storableError } from '../../util/errors';\nimport { addMarketplaceEntities } from '../../ducks/marketplaceData.duck';\nimport { convertUnitToSubUnit, unitDivisor } from '../../util/currency';\nimport { formatDateStringToUTC, getExclusiveEndDate } from '../../util/dates';\nimport config from '../../config'; // ================ Action types ================ //\n\nexport const SEARCH_LISTINGS_REQUEST = 'app/SearchPage/SEARCH_LISTINGS_REQUEST';\nexport const SEARCH_LISTINGS_SUCCESS = 'app/SearchPage/SEARCH_LISTINGS_SUCCESS';\nexport const SEARCH_LISTINGS_ERROR = 'app/SearchPage/SEARCH_LISTINGS_ERROR';\nexport const SEARCH_MAP_LISTINGS_REQUEST = 'app/SearchPage/SEARCH_MAP_LISTINGS_REQUEST';\nexport const SEARCH_MAP_LISTINGS_SUCCESS = 'app/SearchPage/SEARCH_MAP_LISTINGS_SUCCESS';\nexport const SEARCH_MAP_LISTINGS_ERROR = 'app/SearchPage/SEARCH_MAP_LISTINGS_ERROR';\nexport const SEARCH_MAP_SET_ACTIVE_LISTING = 'app/SearchPage/SEARCH_MAP_SET_ACTIVE_LISTING'; // ================ Reducer ================ //\n\nconst initialState = {\n  pagination: null,\n  searchParams: null,\n  searchInProgress: false,\n  searchListingsError: null,\n  currentPageResultIds: [],\n  searchMapListingIds: [],\n  searchMapListingsError: null\n};\n\nconst resultIds = data => data.data.map(l => l.id);\n\nconst listingPageReducer = (state = initialState, action = {}) => {\n  const type = action.type,\n        payload = action.payload;\n\n  switch (type) {\n    case SEARCH_LISTINGS_REQUEST:\n      return _objectSpread({}, state, {\n        searchParams: payload.searchParams,\n        searchInProgress: true,\n        searchMapListingIds: [],\n        searchListingsError: null\n      });\n\n    case SEARCH_LISTINGS_SUCCESS:\n      return _objectSpread({}, state, {\n        currentPageResultIds: resultIds(payload.data),\n        pagination: payload.data.meta,\n        searchInProgress: false\n      });\n\n    case SEARCH_LISTINGS_ERROR:\n      // eslint-disable-next-line no-console\n      console.error(payload);\n      return _objectSpread({}, state, {\n        searchInProgress: false,\n        searchListingsError: payload\n      });\n\n    case SEARCH_MAP_LISTINGS_REQUEST:\n      return _objectSpread({}, state, {\n        searchMapListingsError: null\n      });\n\n    case SEARCH_MAP_LISTINGS_SUCCESS:\n      {\n        const searchMapListingIds = unionWith(state.searchMapListingIds, resultIds(payload.data), (id1, id2) => id1.uuid === id2.uuid);\n        return _objectSpread({}, state, {\n          searchMapListingIds\n        });\n      }\n\n    case SEARCH_MAP_LISTINGS_ERROR:\n      // eslint-disable-next-line no-console\n      console.error(payload);\n      return _objectSpread({}, state, {\n        searchMapListingsError: payload\n      });\n\n    case SEARCH_MAP_SET_ACTIVE_LISTING:\n      return _objectSpread({}, state, {\n        activeListingId: payload\n      });\n\n    default:\n      return state;\n  }\n};\n\nexport default listingPageReducer; // ================ Action creators ================ //\n\nexport const searchListingsRequest = searchParams => ({\n  type: SEARCH_LISTINGS_REQUEST,\n  payload: {\n    searchParams\n  }\n});\nexport const searchListingsSuccess = response => ({\n  type: SEARCH_LISTINGS_SUCCESS,\n  payload: {\n    data: response.data\n  }\n});\nexport const searchListingsError = e => ({\n  type: SEARCH_LISTINGS_ERROR,\n  error: true,\n  payload: e\n});\nexport const searchMapListingsRequest = () => ({\n  type: SEARCH_MAP_LISTINGS_REQUEST\n});\nexport const searchMapListingsSuccess = response => ({\n  type: SEARCH_MAP_LISTINGS_SUCCESS,\n  payload: {\n    data: response.data\n  }\n});\nexport const searchMapListingsError = e => ({\n  type: SEARCH_MAP_LISTINGS_ERROR,\n  error: true,\n  payload: e\n});\nexport const searchListings = searchParams => (dispatch, getState, sdk) => {\n  dispatch(searchListingsRequest(searchParams));\n\n  const priceSearchParams = priceParam => {\n    const inSubunits = value => convertUnitToSubUnit(value, unitDivisor(config.currencyConfig.currency));\n\n    const values = priceParam ? priceParam.split(',') : [];\n    return priceParam && values.length === 2 ? {\n      price: [inSubunits(values[0]), inSubunits(values[1]) + 1].join(',')\n    } : {};\n  };\n\n  const datesSearchParams = datesParam => {\n    const values = datesParam ? datesParam.split(',') : [];\n    const hasValues = datesParam && values.length === 2;\n    const startDate = hasValues ? values[0] : null;\n    const isNightlyBooking = config.bookingUnitType === 'line-item/night';\n    const endDate = hasValues && isNightlyBooking ? values[1] : hasValues ? getExclusiveEndDate(values[1]) : null;\n    return hasValues ? {\n      start: formatDateStringToUTC(startDate),\n      end: formatDateStringToUTC(endDate),\n      // Availability can be full or partial. Default value is full.\n      availability: 'full'\n    } : {};\n  };\n\n  const perPage = searchParams.perPage,\n        price = searchParams.price,\n        dates = searchParams.dates,\n        rest = _objectWithoutProperties(searchParams, [\"perPage\", \"price\", \"dates\"]);\n\n  const priceMaybe = priceSearchParams(price);\n  const datesMaybe = datesSearchParams(dates);\n\n  const params = _objectSpread({}, rest, priceMaybe, datesMaybe, {\n    per_page: perPage\n  });\n\n  return sdk.listings.query(params).then(response => {\n    dispatch(addMarketplaceEntities(response));\n    dispatch(searchListingsSuccess(response));\n    return response;\n  }).catch(e => {\n    dispatch(searchListingsError(storableError(e)));\n    throw e;\n  });\n};\nexport const setActiveListing = listingId => ({\n  type: SEARCH_MAP_SET_ACTIVE_LISTING,\n  payload: listingId\n});\nexport const searchMapListings = searchParams => (dispatch, getState, sdk) => {\n  dispatch(searchMapListingsRequest(searchParams));\n\n  const perPage = searchParams.perPage,\n        rest = _objectWithoutProperties(searchParams, [\"perPage\"]);\n\n  const params = _objectSpread({}, rest, {\n    per_page: perPage\n  });\n\n  return sdk.listings.query(params).then(response => {\n    dispatch(addMarketplaceEntities(response));\n    dispatch(searchMapListingsSuccess(response));\n    return response;\n  }).catch(e => {\n    dispatch(searchMapListingsError(storableError(e)));\n    throw e;\n  });\n};","map":{"version":3,"sources":["/Users/matthewmcelwee/fcprepos/webtest1/flex-template-web/src/containers/SearchPage/SearchPage.duck.js"],"names":["unionWith","storableError","addMarketplaceEntities","convertUnitToSubUnit","unitDivisor","formatDateStringToUTC","getExclusiveEndDate","config","SEARCH_LISTINGS_REQUEST","SEARCH_LISTINGS_SUCCESS","SEARCH_LISTINGS_ERROR","SEARCH_MAP_LISTINGS_REQUEST","SEARCH_MAP_LISTINGS_SUCCESS","SEARCH_MAP_LISTINGS_ERROR","SEARCH_MAP_SET_ACTIVE_LISTING","initialState","pagination","searchParams","searchInProgress","searchListingsError","currentPageResultIds","searchMapListingIds","searchMapListingsError","resultIds","data","map","l","id","listingPageReducer","state","action","type","payload","meta","console","error","id1","id2","uuid","activeListingId","searchListingsRequest","searchListingsSuccess","response","e","searchMapListingsRequest","searchMapListingsSuccess","searchListings","dispatch","getState","sdk","priceSearchParams","priceParam","inSubunits","value","currencyConfig","currency","values","split","length","price","join","datesSearchParams","datesParam","hasValues","startDate","isNightlyBooking","bookingUnitType","endDate","start","end","availability","perPage","dates","rest","priceMaybe","datesMaybe","params","per_page","listings","query","then","catch","setActiveListing","listingId","searchMapListings"],"mappings":"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","sourcesContent":["import unionWith from 'lodash/unionWith';\nimport { storableError } from '../../util/errors';\nimport { addMarketplaceEntities } from '../../ducks/marketplaceData.duck';\nimport { convertUnitToSubUnit, unitDivisor } from '../../util/currency';\nimport { formatDateStringToUTC, getExclusiveEndDate } from '../../util/dates';\nimport config from '../../config';\n\n// ================ Action types ================ //\n\nexport const SEARCH_LISTINGS_REQUEST = 'app/SearchPage/SEARCH_LISTINGS_REQUEST';\nexport const SEARCH_LISTINGS_SUCCESS = 'app/SearchPage/SEARCH_LISTINGS_SUCCESS';\nexport const SEARCH_LISTINGS_ERROR = 'app/SearchPage/SEARCH_LISTINGS_ERROR';\n\nexport const SEARCH_MAP_LISTINGS_REQUEST = 'app/SearchPage/SEARCH_MAP_LISTINGS_REQUEST';\nexport const SEARCH_MAP_LISTINGS_SUCCESS = 'app/SearchPage/SEARCH_MAP_LISTINGS_SUCCESS';\nexport const SEARCH_MAP_LISTINGS_ERROR = 'app/SearchPage/SEARCH_MAP_LISTINGS_ERROR';\n\nexport const SEARCH_MAP_SET_ACTIVE_LISTING = 'app/SearchPage/SEARCH_MAP_SET_ACTIVE_LISTING';\n\n// ================ Reducer ================ //\n\nconst initialState = {\n  pagination: null,\n  searchParams: null,\n  searchInProgress: false,\n  searchListingsError: null,\n  currentPageResultIds: [],\n  searchMapListingIds: [],\n  searchMapListingsError: null,\n};\n\nconst resultIds = data => data.data.map(l => l.id);\n\nconst listingPageReducer = (state = initialState, action = {}) => {\n  const { type, payload } = action;\n  switch (type) {\n    case SEARCH_LISTINGS_REQUEST:\n      return {\n        ...state,\n        searchParams: payload.searchParams,\n        searchInProgress: true,\n        searchMapListingIds: [],\n        searchListingsError: null,\n      };\n    case SEARCH_LISTINGS_SUCCESS:\n      return {\n        ...state,\n        currentPageResultIds: resultIds(payload.data),\n        pagination: payload.data.meta,\n        searchInProgress: false,\n      };\n    case SEARCH_LISTINGS_ERROR:\n      // eslint-disable-next-line no-console\n      console.error(payload);\n      return { ...state, searchInProgress: false, searchListingsError: payload };\n\n    case SEARCH_MAP_LISTINGS_REQUEST:\n      return {\n        ...state,\n        searchMapListingsError: null,\n      };\n    case SEARCH_MAP_LISTINGS_SUCCESS: {\n      const searchMapListingIds = unionWith(\n        state.searchMapListingIds,\n        resultIds(payload.data),\n        (id1, id2) => id1.uuid === id2.uuid\n      );\n      return {\n        ...state,\n        searchMapListingIds,\n      };\n    }\n    case SEARCH_MAP_LISTINGS_ERROR:\n      // eslint-disable-next-line no-console\n      console.error(payload);\n      return { ...state, searchMapListingsError: payload };\n\n    case SEARCH_MAP_SET_ACTIVE_LISTING:\n      return {\n        ...state,\n        activeListingId: payload,\n      };\n    default:\n      return state;\n  }\n};\n\nexport default listingPageReducer;\n\n// ================ Action creators ================ //\n\nexport const searchListingsRequest = searchParams => ({\n  type: SEARCH_LISTINGS_REQUEST,\n  payload: { searchParams },\n});\n\nexport const searchListingsSuccess = response => ({\n  type: SEARCH_LISTINGS_SUCCESS,\n  payload: { data: response.data },\n});\n\nexport const searchListingsError = e => ({\n  type: SEARCH_LISTINGS_ERROR,\n  error: true,\n  payload: e,\n});\n\nexport const searchMapListingsRequest = () => ({ type: SEARCH_MAP_LISTINGS_REQUEST });\n\nexport const searchMapListingsSuccess = response => ({\n  type: SEARCH_MAP_LISTINGS_SUCCESS,\n  payload: { data: response.data },\n});\n\nexport const searchMapListingsError = e => ({\n  type: SEARCH_MAP_LISTINGS_ERROR,\n  error: true,\n  payload: e,\n});\n\nexport const searchListings = searchParams => (dispatch, getState, sdk) => {\n  dispatch(searchListingsRequest(searchParams));\n\n  const priceSearchParams = priceParam => {\n    const inSubunits = value =>\n      convertUnitToSubUnit(value, unitDivisor(config.currencyConfig.currency));\n    const values = priceParam ? priceParam.split(',') : [];\n    return priceParam && values.length === 2\n      ? {\n          price: [inSubunits(values[0]), inSubunits(values[1]) + 1].join(','),\n        }\n      : {};\n  };\n\n  const datesSearchParams = datesParam => {\n    const values = datesParam ? datesParam.split(',') : [];\n    const hasValues = datesParam && values.length === 2;\n    const startDate = hasValues ? values[0] : null;\n    const isNightlyBooking = config.bookingUnitType === 'line-item/night';\n    const endDate =\n      hasValues && isNightlyBooking ? values[1] : hasValues ? getExclusiveEndDate(values[1]) : null;\n\n    return hasValues\n      ? {\n          start: formatDateStringToUTC(startDate),\n          end: formatDateStringToUTC(endDate),\n          // Availability can be full or partial. Default value is full.\n          availability: 'full',\n        }\n      : {};\n  };\n\n  const { perPage, price, dates, ...rest } = searchParams;\n  const priceMaybe = priceSearchParams(price);\n  const datesMaybe = datesSearchParams(dates);\n\n  const params = {\n    ...rest,\n    ...priceMaybe,\n    ...datesMaybe,\n    per_page: perPage,\n  };\n\n  return sdk.listings\n    .query(params)\n    .then(response => {\n      dispatch(addMarketplaceEntities(response));\n      dispatch(searchListingsSuccess(response));\n      return response;\n    })\n    .catch(e => {\n      dispatch(searchListingsError(storableError(e)));\n      throw e;\n    });\n};\n\nexport const setActiveListing = listingId => ({\n  type: SEARCH_MAP_SET_ACTIVE_LISTING,\n  payload: listingId,\n});\n\nexport const searchMapListings = searchParams => (dispatch, getState, sdk) => {\n  dispatch(searchMapListingsRequest(searchParams));\n\n  const { perPage, ...rest } = searchParams;\n  const params = {\n    ...rest,\n    per_page: perPage,\n  };\n\n  return sdk.listings\n    .query(params)\n    .then(response => {\n      dispatch(addMarketplaceEntities(response));\n      dispatch(searchMapListingsSuccess(response));\n      return response;\n    })\n    .catch(e => {\n      dispatch(searchMapListingsError(storableError(e)));\n      throw e;\n    });\n};\n"]},"metadata":{},"sourceType":"module"}