{"ast":null,"code":"/**\n * ================ API error handling utilities ================\n *\n * This module exports helpers that can be used to check if API\n * response errors are some specific error cases.\n *\n * NOTE: most of the functions are tied to an endpoint, and should not\n * be used to check error responses from any other endpoint. Check the\n * name and the docstring of the function to ensure correct usage.\n */\nimport { ERROR_CODE_TRANSACTION_LISTING_NOT_FOUND, ERROR_CODE_TRANSACTION_INVALID_TRANSITION, ERROR_CODE_TRANSACTION_ALREADY_REVIEWED_BY_CUSTOMER, ERROR_CODE_TRANSACTION_ALREADY_REVIEWED_BY_PROVIDER, ERROR_CODE_PAYMENT_FAILED, ERROR_CODE_CHARGE_ZERO_PAYIN, ERROR_CODE_EMAIL_TAKEN, ERROR_CODE_EMAIL_NOT_FOUND, ERROR_CODE_TOO_MANY_VERIFICATION_REQUESTS, ERROR_CODE_UPLOAD_OVER_LIMIT, ERROR_CODE_MISSING_STRIPE_ACCOUNT, ERROR_CODE_TRANSACTION_BOOKING_TIME_NOT_AVAILABLE } from './types';\n\nconst errorAPIErrors = error => {\n  return error && error.apiErrors ? error.apiErrors : [];\n};\n\nconst hasErrorWithCode = (error, code) => {\n  return errorAPIErrors(error).some(apiError => {\n    return apiError.code === code;\n  });\n};\n/**\n * return apiErrors from error response\n */\n\n\nconst responseAPIErrors = error => {\n  return error && error.data && error.data.errors ? error.data.errors : [];\n};\n/**\n * Check if the given API error (from `sdk.currentuser.create()`) is\n * due to the email address already being in use.\n */\n\n\nexport const isSignupEmailTakenError = error => hasErrorWithCode(error, ERROR_CODE_EMAIL_TAKEN);\n/**\n * Check if the given API error (from `sdk.currentuser.changeEmail()`) is\n * due to the email address already being in use.\n */\n\nexport const isChangeEmailTakenError = error => hasErrorWithCode(error, ERROR_CODE_EMAIL_TAKEN);\n/**\n * Check if the given API error (from\n * `sdk.currentUser.sendVerificationEmail()`) is due to too many\n * active email verification requests.\n *\n * There qre only a specific amount of active verification requests\n * allowed, and the user has to wait for them to expire to be able to\n * request sending new verification emails.\n */\n\nexport const isTooManyEmailVerificationRequestsError = error => hasErrorWithCode(error, ERROR_CODE_TOO_MANY_VERIFICATION_REQUESTS);\n/**\n * Check if the given API error (from\n * `sdk.images.upload()`) is due to the image being over\n * the size limit.\n */\n\nexport const isUploadImageOverLimitError = error => hasErrorWithCode(error, ERROR_CODE_UPLOAD_OVER_LIMIT);\n/**\n * Check if the given API error (from `sdk.passwordReset.request()`)\n * is due to no user having the given email address.\n */\n\nexport const isPasswordRecoveryEmailNotFoundError = error => hasErrorWithCode(error, ERROR_CODE_EMAIL_NOT_FOUND);\n/**\n * Check if the given API error (from `sdk.transaction.initiate()` or\n * `sdk.transaction.initiateSpeculative()`) is due to the listing\n * being closed or deleted.\n */\n\nexport const isTransactionInitiateListingNotFoundError = error => hasErrorWithCode(error, ERROR_CODE_TRANSACTION_LISTING_NOT_FOUND);\n/**\n * Check if the given API error (from `sdk.transaction.initiate()` or\n * `sdk.transaction.initiateSpeculative()`) is due to missign Stripe\n * connection from the listing author.\n */\n\nexport const isTransactionInitiateMissingStripeAccountError = error => hasErrorWithCode(error, ERROR_CODE_MISSING_STRIPE_ACCOUNT);\n/**\n * Check if the given API error (from `sdk.transaction.initiate()` or\n * `sdk.transaction.initiateSpeculative()`) is due to selected booking\n * time already being booked.\n */\n\nexport const isTransactionInitiateBookingTimeNotAvailableError = error => hasErrorWithCode(error, ERROR_CODE_TRANSACTION_BOOKING_TIME_NOT_AVAILABLE);\n/**\n * Check if the given API error (from `sdk.transaction.initiate()` or\n * `sdk.transaction.initiateSpeculative()`) is due to payment being zero.\n */\n\nexport const isTransactionZeroPaymentError = error => hasErrorWithCode(error, ERROR_CODE_CHARGE_ZERO_PAYIN);\n/**\n * Check if the given API error (from `sdk.transaction.initiate()`) is\n * due to the transaction total amount being too low for Stripe.\n */\n\nexport const isTransactionInitiateAmountTooLowError = error => {\n  const isZeroPayment = isTransactionZeroPaymentError(error);\n  const tooLowAmount = errorAPIErrors(error).some(apiError => {\n    const isPaymentFailedError = apiError.status === 402 && apiError.code === ERROR_CODE_PAYMENT_FAILED;\n    let isAmountTooLow = false;\n\n    try {\n      // TODO: This is a temporary solution until a proper error code\n      // for this specific error is received in the response.\n      const msg = apiError.meta.stripeMessage;\n      isAmountTooLow = msg.startsWith('Amount must be at least') || msg.startsWith('Amount must convert to at least');\n    } catch (e) {// Ignore\n    }\n\n    return isPaymentFailedError && isAmountTooLow;\n  });\n  return isZeroPayment || tooLowAmount;\n};\n/**\n * Check if the given API error (from `sdk.transaction.initiate()`) is\n * due to other error in Stripe.\n */\n\nexport const transactionInitiateOrderStripeErrors = error => {\n  if (error) {\n    return errorAPIErrors(error).reduce((messages, apiError) => {\n      const isPaymentFailedError = apiError.status === 402 && apiError.code === ERROR_CODE_PAYMENT_FAILED;\n      const hasStripeError = apiError && apiError.meta && apiError.meta.stripeMessage;\n      const stripeMessageMaybe = isPaymentFailedError && hasStripeError ? [apiError.meta.stripeMessage] : [];\n      return [...messages, ...stripeMessageMaybe];\n    }, []);\n  }\n\n  return null;\n};\n/**\n * Check if the given API error (from `sdk.transactions.transition(id, transition, params)`)\n * is due to invalid transition attempt.\n */\n\nexport const isTransactionsTransitionInvalidTransition = error => error && error.status === 409 && hasErrorWithCode(error, ERROR_CODE_TRANSACTION_INVALID_TRANSITION);\n/**\n * Check if the given API error (from `sdk.transactions.transition(id, transition, params)`)\n * is due to already sent review.\n */\n\nexport const isTransactionsTransitionAlreadyReviewed = error => error && error.status === 409 && (hasErrorWithCode(error, ERROR_CODE_TRANSACTION_ALREADY_REVIEWED_BY_CUSTOMER) || hasErrorWithCode(error, ERROR_CODE_TRANSACTION_ALREADY_REVIEWED_BY_PROVIDER));\n/**\n * Check if the given API error (from `sdk.currentUser.changeEmail(params)`)\n * is due to giving wrong password.\n */\n\nexport const isChangeEmailWrongPassword = error => error && error.status === 403;\n/**\n * Check if the given API error (from `sdk.currentUser.changePassword(params)`)\n * is due to giving wrong password.\n */\n\nexport const isChangePasswordWrongPassword = error => error && error.status === 403;\n/**\n * Check if the given API error (from\n * 'sdk.stripeAccount.create(payoutDetails)') is due to\n * invalid postal code in the given country.\n */\n\nexport const isStripeInvalidPostalCode = error => {\n  const msgRe = /^Invalid [A-Z]{2} postal code$/;\n  return errorAPIErrors(error).some(apiError => {\n    // Stripe doesn't seem to give an error code for this specific\n    // case, so we have to recognize it from the message.\n    const msg = apiError.meta && apiError.meta.stripeMessage ? apiError.meta.stripeMessage : '';\n    return msgRe.test(msg);\n  });\n};\nexport const isStripeError = error => {\n  return errorAPIErrors(error).some(apiError => {\n    // Stripe doesn't seem to give an error code for this specific\n    // case, so we have to recognize it from the message.\n    return !!(apiError.meta && apiError.meta.stripeMessage);\n  });\n};\nexport const storableError = err => {\n  const error = err || {};\n  const name = error.name,\n        message = error.message,\n        status = error.status,\n        statusText = error.statusText; // Status, statusText, and data.errors are (possibly) added to the error object by SDK\n\n  const apiErrors = responseAPIErrors(error); // Returned object is the same as prop type check in util/types -> error\n\n  return {\n    type: 'error',\n    name,\n    message,\n    status,\n    statusText,\n    apiErrors\n  };\n};\nexport const responseApiErrorInfo = err => responseAPIErrors(err).map(e => ({\n  status: e.status,\n  code: e.code,\n  meta: e.meta\n}));","map":{"version":3,"sources":["/Users/matthewmcelwee/fcprepos/webtest1/flex-template-web/src/util/errors.js"],"names":["ERROR_CODE_TRANSACTION_LISTING_NOT_FOUND","ERROR_CODE_TRANSACTION_INVALID_TRANSITION","ERROR_CODE_TRANSACTION_ALREADY_REVIEWED_BY_CUSTOMER","ERROR_CODE_TRANSACTION_ALREADY_REVIEWED_BY_PROVIDER","ERROR_CODE_PAYMENT_FAILED","ERROR_CODE_CHARGE_ZERO_PAYIN","ERROR_CODE_EMAIL_TAKEN","ERROR_CODE_EMAIL_NOT_FOUND","ERROR_CODE_TOO_MANY_VERIFICATION_REQUESTS","ERROR_CODE_UPLOAD_OVER_LIMIT","ERROR_CODE_MISSING_STRIPE_ACCOUNT","ERROR_CODE_TRANSACTION_BOOKING_TIME_NOT_AVAILABLE","errorAPIErrors","error","apiErrors","hasErrorWithCode","code","some","apiError","responseAPIErrors","data","errors","isSignupEmailTakenError","isChangeEmailTakenError","isTooManyEmailVerificationRequestsError","isUploadImageOverLimitError","isPasswordRecoveryEmailNotFoundError","isTransactionInitiateListingNotFoundError","isTransactionInitiateMissingStripeAccountError","isTransactionInitiateBookingTimeNotAvailableError","isTransactionZeroPaymentError","isTransactionInitiateAmountTooLowError","isZeroPayment","tooLowAmount","isPaymentFailedError","status","isAmountTooLow","msg","meta","stripeMessage","startsWith","e","transactionInitiateOrderStripeErrors","reduce","messages","hasStripeError","stripeMessageMaybe","isTransactionsTransitionInvalidTransition","isTransactionsTransitionAlreadyReviewed","isChangeEmailWrongPassword","isChangePasswordWrongPassword","isStripeInvalidPostalCode","msgRe","test","isStripeError","storableError","err","name","message","statusText","type","responseApiErrorInfo","map"],"mappings":"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","sourcesContent":["/**\n * ================ API error handling utilities ================\n *\n * This module exports helpers that can be used to check if API\n * response errors are some specific error cases.\n *\n * NOTE: most of the functions are tied to an endpoint, and should not\n * be used to check error responses from any other endpoint. Check the\n * name and the docstring of the function to ensure correct usage.\n */\n\nimport {\n  ERROR_CODE_TRANSACTION_LISTING_NOT_FOUND,\n  ERROR_CODE_TRANSACTION_INVALID_TRANSITION,\n  ERROR_CODE_TRANSACTION_ALREADY_REVIEWED_BY_CUSTOMER,\n  ERROR_CODE_TRANSACTION_ALREADY_REVIEWED_BY_PROVIDER,\n  ERROR_CODE_PAYMENT_FAILED,\n  ERROR_CODE_CHARGE_ZERO_PAYIN,\n  ERROR_CODE_EMAIL_TAKEN,\n  ERROR_CODE_EMAIL_NOT_FOUND,\n  ERROR_CODE_TOO_MANY_VERIFICATION_REQUESTS,\n  ERROR_CODE_UPLOAD_OVER_LIMIT,\n  ERROR_CODE_MISSING_STRIPE_ACCOUNT,\n  ERROR_CODE_TRANSACTION_BOOKING_TIME_NOT_AVAILABLE,\n} from './types';\n\nconst errorAPIErrors = error => {\n  return error && error.apiErrors ? error.apiErrors : [];\n};\n\nconst hasErrorWithCode = (error, code) => {\n  return errorAPIErrors(error).some(apiError => {\n    return apiError.code === code;\n  });\n};\n\n/**\n * return apiErrors from error response\n */\nconst responseAPIErrors = error => {\n  return error && error.data && error.data.errors ? error.data.errors : [];\n};\n\n/**\n * Check if the given API error (from `sdk.currentuser.create()`) is\n * due to the email address already being in use.\n */\nexport const isSignupEmailTakenError = error => hasErrorWithCode(error, ERROR_CODE_EMAIL_TAKEN);\n\n/**\n * Check if the given API error (from `sdk.currentuser.changeEmail()`) is\n * due to the email address already being in use.\n */\nexport const isChangeEmailTakenError = error => hasErrorWithCode(error, ERROR_CODE_EMAIL_TAKEN);\n\n/**\n * Check if the given API error (from\n * `sdk.currentUser.sendVerificationEmail()`) is due to too many\n * active email verification requests.\n *\n * There qre only a specific amount of active verification requests\n * allowed, and the user has to wait for them to expire to be able to\n * request sending new verification emails.\n */\nexport const isTooManyEmailVerificationRequestsError = error =>\n  hasErrorWithCode(error, ERROR_CODE_TOO_MANY_VERIFICATION_REQUESTS);\n\n/**\n * Check if the given API error (from\n * `sdk.images.upload()`) is due to the image being over\n * the size limit.\n */\nexport const isUploadImageOverLimitError = error =>\n  hasErrorWithCode(error, ERROR_CODE_UPLOAD_OVER_LIMIT);\n\n/**\n * Check if the given API error (from `sdk.passwordReset.request()`)\n * is due to no user having the given email address.\n */\nexport const isPasswordRecoveryEmailNotFoundError = error =>\n  hasErrorWithCode(error, ERROR_CODE_EMAIL_NOT_FOUND);\n\n/**\n * Check if the given API error (from `sdk.transaction.initiate()` or\n * `sdk.transaction.initiateSpeculative()`) is due to the listing\n * being closed or deleted.\n */\nexport const isTransactionInitiateListingNotFoundError = error =>\n  hasErrorWithCode(error, ERROR_CODE_TRANSACTION_LISTING_NOT_FOUND);\n\n/**\n * Check if the given API error (from `sdk.transaction.initiate()` or\n * `sdk.transaction.initiateSpeculative()`) is due to missign Stripe\n * connection from the listing author.\n */\nexport const isTransactionInitiateMissingStripeAccountError = error =>\n  hasErrorWithCode(error, ERROR_CODE_MISSING_STRIPE_ACCOUNT);\n\n/**\n * Check if the given API error (from `sdk.transaction.initiate()` or\n * `sdk.transaction.initiateSpeculative()`) is due to selected booking\n * time already being booked.\n */\nexport const isTransactionInitiateBookingTimeNotAvailableError = error =>\n  hasErrorWithCode(error, ERROR_CODE_TRANSACTION_BOOKING_TIME_NOT_AVAILABLE);\n\n/**\n * Check if the given API error (from `sdk.transaction.initiate()` or\n * `sdk.transaction.initiateSpeculative()`) is due to payment being zero.\n */\nexport const isTransactionZeroPaymentError = error =>\n  hasErrorWithCode(error, ERROR_CODE_CHARGE_ZERO_PAYIN);\n\n/**\n * Check if the given API error (from `sdk.transaction.initiate()`) is\n * due to the transaction total amount being too low for Stripe.\n */\nexport const isTransactionInitiateAmountTooLowError = error => {\n  const isZeroPayment = isTransactionZeroPaymentError(error);\n\n  const tooLowAmount = errorAPIErrors(error).some(apiError => {\n    const isPaymentFailedError =\n      apiError.status === 402 && apiError.code === ERROR_CODE_PAYMENT_FAILED;\n    let isAmountTooLow = false;\n\n    try {\n      // TODO: This is a temporary solution until a proper error code\n      // for this specific error is received in the response.\n      const msg = apiError.meta.stripeMessage;\n      isAmountTooLow =\n        msg.startsWith('Amount must be at least') ||\n        msg.startsWith('Amount must convert to at least');\n    } catch (e) {\n      // Ignore\n    }\n\n    return isPaymentFailedError && isAmountTooLow;\n  });\n\n  return isZeroPayment || tooLowAmount;\n};\n\n/**\n * Check if the given API error (from `sdk.transaction.initiate()`) is\n * due to other error in Stripe.\n */\nexport const transactionInitiateOrderStripeErrors = error => {\n  if (error) {\n    return errorAPIErrors(error).reduce((messages, apiError) => {\n      const isPaymentFailedError =\n        apiError.status === 402 && apiError.code === ERROR_CODE_PAYMENT_FAILED;\n      const hasStripeError = apiError && apiError.meta && apiError.meta.stripeMessage;\n      const stripeMessageMaybe =\n        isPaymentFailedError && hasStripeError ? [apiError.meta.stripeMessage] : [];\n      return [...messages, ...stripeMessageMaybe];\n    }, []);\n  }\n  return null;\n};\n\n/**\n * Check if the given API error (from `sdk.transactions.transition(id, transition, params)`)\n * is due to invalid transition attempt.\n */\nexport const isTransactionsTransitionInvalidTransition = error =>\n  error &&\n  error.status === 409 &&\n  hasErrorWithCode(error, ERROR_CODE_TRANSACTION_INVALID_TRANSITION);\n\n/**\n * Check if the given API error (from `sdk.transactions.transition(id, transition, params)`)\n * is due to already sent review.\n */\nexport const isTransactionsTransitionAlreadyReviewed = error =>\n  error &&\n  error.status === 409 &&\n  (hasErrorWithCode(error, ERROR_CODE_TRANSACTION_ALREADY_REVIEWED_BY_CUSTOMER) ||\n    hasErrorWithCode(error, ERROR_CODE_TRANSACTION_ALREADY_REVIEWED_BY_PROVIDER));\n\n/**\n * Check if the given API error (from `sdk.currentUser.changeEmail(params)`)\n * is due to giving wrong password.\n */\nexport const isChangeEmailWrongPassword = error => error && error.status === 403;\n\n/**\n * Check if the given API error (from `sdk.currentUser.changePassword(params)`)\n * is due to giving wrong password.\n */\nexport const isChangePasswordWrongPassword = error => error && error.status === 403;\n\n/**\n * Check if the given API error (from\n * 'sdk.stripeAccount.create(payoutDetails)') is due to\n * invalid postal code in the given country.\n */\nexport const isStripeInvalidPostalCode = error => {\n  const msgRe = /^Invalid [A-Z]{2} postal code$/;\n  return errorAPIErrors(error).some(apiError => {\n    // Stripe doesn't seem to give an error code for this specific\n    // case, so we have to recognize it from the message.\n    const msg = apiError.meta && apiError.meta.stripeMessage ? apiError.meta.stripeMessage : '';\n    return msgRe.test(msg);\n  });\n};\n\nexport const isStripeError = error => {\n  return errorAPIErrors(error).some(apiError => {\n    // Stripe doesn't seem to give an error code for this specific\n    // case, so we have to recognize it from the message.\n    return !!(apiError.meta && apiError.meta.stripeMessage);\n  });\n};\n\nexport const storableError = err => {\n  const error = err || {};\n  const { name, message, status, statusText } = error;\n  // Status, statusText, and data.errors are (possibly) added to the error object by SDK\n  const apiErrors = responseAPIErrors(error);\n\n  // Returned object is the same as prop type check in util/types -> error\n  return {\n    type: 'error',\n    name,\n    message,\n    status,\n    statusText,\n    apiErrors,\n  };\n};\n\nexport const responseApiErrorInfo = err =>\n  responseAPIErrors(err).map(e => ({\n    status: e.status,\n    code: e.code,\n    meta: e.meta,\n  }));\n"]},"metadata":{},"sourceType":"module"}